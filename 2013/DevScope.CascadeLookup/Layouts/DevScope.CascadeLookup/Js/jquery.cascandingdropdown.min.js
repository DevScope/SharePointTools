(function(n,t){"use strict";function i(t,i){this.el=n(t.selector,i.el);this.parent=i;this.options=n.extend({},u,t);this.name=this.options.paramName||this.el.attr("name");this.requiredDropdowns=t.requires&&t.requires.length?n(t.requires.join(","),i.el):null;this.isLoadingClassName=this.options.isLoadingClassName||i.options.isLoadingClassName||"cascading-dropdown-loading"}function r(t,i){this.el=n(t);this.options=n.extend({selectBoxes:[]},i);this._init()}var u={usePost:!1,useJson:!1,selectBoxes:[]};i.prototype={_create:function(){var n=this;n.pending=0;n.initialised=!1;n.originalDropdownItems=n.el.children("option");typeof n.options.onChange=="function"&&n.el.change(function(t){var i=n._requirementsMet()&&n.el[0].value;n.options.onChange.call(n,t,n.el.val(),n.getRequiredValues(),i)});n.requiredDropdowns&&n.requiredDropdowns.change(function(){n.update()});n._initSource();n.update()},enable:function(){return this.el.removeAttr("disabled").triggerHandler("enabled")},disable:function(){return this.el.attr("disabled","disabled").triggerHandler("disabled")},_requirementsMet:function(){var t=this;return t.requiredDropdowns?t.options.requireAll?t.requiredDropdowns.filter(function(){return!!n(this).val()}).length==t.options.requires.length:t.requiredDropdowns.filter(function(){return!!n(this).val()}).length>0:!0},_initSource:function(){var i=this,r;n.isArray(i.options.source)?this.source=function(t,r){r(n.map(i.options.source,function(n){return{label:n.label||n.value||n,value:n.value||n.label||n,selected:n.selected}}))}:typeof i.options.source=="string"?(r=i.options.source,this.source=function(u,f){i.xhr&&i.xhr.abort();i.xhr=n.ajax({url:r,data:i.options.useJson?JSON.stringify(u):u,dataType:i.options.useJson?"json":t,type:i.options.usePost?"post":"get",contentType:"application/json; charset=utf-8",async:!1,success:function(n){n.hasOwnProperty("d")&&(n=n.d);f(n)},error:function(){f([])}})}):this.source=i.options.source},getRequiredValues:function(){var t={};return this.requiredDropdowns&&n.each(this.requiredDropdowns,function(){var i=n(this).data("plugin_cascadingDropdown");i.name&&(t[i.name]=i.el.val())}),t},update:function(){var n=this,t;return(n.disable(),!n._requirementsMet())?(n.setSelected(0),n._triggerReady(),n.el):n.source?(n.el.val("").change(),t=n.getRequiredValues(),n.pending++,n.el.addClass(n.isLoadingClassName),n.source(t,n._response()),n.el):(n.enable(),n._triggerReady(),n.el)},_response:function(){var n=this;return function(t){n._renderItems(t);n.pending--;n.pending||n.el.removeClass(n.isLoadingClassName)}},_renderItems:function(t){var i=this,r;if(i.el.children("option").remove(),i.el.append(i.originalDropdownItems),!t||!t.length){i._triggerReady();return}n.each(t,function(n,t){t.selected&&(r=t);i.el.append('<option value="'+t.value+'">'+t.label+"<\/option>")});i._requirementsMet()&&(i.enable(),r&&i.setSelected(r.value.toString()),i._triggerReady(),i.el.change())},_triggerReady:function(){this.initialised||(this.options.selected&&this.setSelected(this.options.selected),this.initialised=!0,this.el.triggerHandler("ready"))},setSelected:function(n,i){var r=this,u=r.el.find("option");if(typeof i=="undefined"&&(i=!0),typeof n=="string"&&(n=u.index(u.filter(function(){return this.value===n})[0])),n!==t&&!(n<0)&&!(n>u.length))return r.el[0].selectedIndex=n,i&&r.el.change(),r.el}};r.prototype={_init:function(){function f(n){++u==r.length&&(r.unbind("ready",f),t.options.onReady.call(t,n,t.getValues()))}function e(n){t.options.onChange.call(t,n,t.getValues())}var t=this,r,u;t.pending=0;t.dropdowns=[];r=n(n.map(t.options.selectBoxes,function(n){return n.selector}).join(","),t.el);u=0;typeof t.options.onReady=="function"&&r.bind("ready",f);typeof t.options.onChange=="function"&&r.bind("change",e);n.each(t.options.selectBoxes,function(){var r=new i(this,t);n(this.selector,t.el).data("plugin_cascadingDropdown",r);t.dropdowns.push(r);r._create()})},getValues:function(){var t={};return n.each(this.dropdowns,function(n,i){i.name&&(t[i.name]=i.el.val())}),t}};n.fn.cascadingDropdown=function(t){var u=n(this),f=arguments,i=u.data("plugin_cascadingDropdown");if(typeof t!="object"&&t)if(typeof t=="string")if(i){if(i[t])return i[t].apply(i,Array.prototype.slice.call(f,1))}else n.error("Cannot call method "+t+" before init.");else n.error("Method "+t+" does not exist in jQuery.cascadingDropdown");else return!i&&u.data("plugin_cascadingDropdown",new r(this,t))}})(jQuery);
/*
//# sourceMappingURL=jquery.cascandingdropdown.min.js.map
*/